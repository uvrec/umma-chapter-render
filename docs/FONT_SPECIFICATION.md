# Специфікація шрифту для української транслітерації санскриту

## Мета

Створити (або модифікувати існуючий) шрифт з правильним позиціонуванням діакритичних знаків (combining characters) на **кириличних** літерах для транслітерації санскриту українською мовою.

## Проблема

Більшість шрифтів мають GPOS (Glyph Positioning) таблиці тільки для **латиниці + діакритика**, але не для **кирилиці + діакритика**. Це призводить до "розвалювання" — діакритичні знаки відображаються окремо від базової літери.

**Приклад проблеми:**
```
Очікувано: н̇  (н з крапкою зверху, як єдиний гліф)
Реально:   н ̇ (н + окрема крапка зсунута вбік)
```

---

## Combining Diacritics (що потрібні)

| Unicode | Назва | Призначення |
|---------|-------|-------------|
| U+0304 | COMBINING MACRON | Довгі голосні (ā, ī, ū) |
| U+0307 | COMBINING DOT ABOVE | Анусвара (ṁ), велярна н (ṅ) |
| U+0323 | COMBINING DOT BELOW | Ретрофлексні (ṭ, ḍ, ṇ, ṛ, ḷ, ḥ) |
| U+0301 | COMBINING ACUTE ACCENT | Палатальна ш (ś) |
| U+0303 | COMBINING TILDE | Палатальна н (ñ) |
| U+0310 | COMBINING CANDRABINDU | Назалізація (м̐, л̐) |

---

## Повний список комбінацій

### 1. Голосні з макроном (U+0304)

| Комбінація | Base + Combining | Unicode послідовність | IAST еквівалент |
|------------|------------------|----------------------|-----------------|
| а̄ | а + ◌̄ | U+0430 U+0304 | ā |
| А̄ | А + ◌̄ | U+0410 U+0304 | Ā |
| і̄ | і + ◌̄ | U+0456 U+0304 | ī |
| Ī | І + ◌̄ | U+0406 U+0304 | Ī |
| ӯ | precomposed | U+04EF | ū |
| Ӯ | precomposed | U+04EE | Ū |

> **Примітка:** Для `ī` використовуємо латинську dotless i (`ı̄` U+0131 U+0304) щоб уникнути двох крапок. Альтернатива — кирилична `і̄` (U+0456 U+0304).

### 2. Приголосні з крапкою знизу (U+0323)

| Комбінація | Base + Combining | Unicode послідовність | IAST еквівалент |
|------------|------------------|----------------------|-----------------|
| т̣ | т + ◌̣ | U+0442 U+0323 | ṭ (retroflex t) |
| Т̣ | Т + ◌̣ | U+0422 U+0323 | Ṭ |
| д̣ | д + ◌̣ | U+0434 U+0323 | ḍ (retroflex d) |
| Д̣ | Д + ◌̣ | U+0414 U+0323 | Ḍ |
| н̣ | н + ◌̣ | U+043D U+0323 | ṇ (retroflex n) |
| Н̣ | Н + ◌̣ | U+041D U+0323 | Ṇ |
| р̣ | р + ◌̣ | U+0440 U+0323 | ṛ (vocalic r) |
| Р̣ | Р + ◌̣ | U+0420 U+0323 | Ṛ |
| л̣ | л + ◌̣ | U+043B U+0323 | ḷ (vocalic l) |
| Л̣ | Л + ◌̣ | U+041B U+0323 | Ḷ |
| х̣ | х + ◌̣ | U+0445 U+0323 | ḥ (visarga) |
| Х̣ | Х + ◌̣ | U+0425 U+0323 | Ḥ |
| м̣ | м + ◌̣ | U+043C U+0323 | ṃ |
| М̣ | М + ◌̣ | U+041C U+0323 | Ṃ |

### 3. Приголосні з крапкою зверху (U+0307)

| Комбінація | Base + Combining | Unicode послідовність | IAST еквівалент |
|------------|------------------|----------------------|-----------------|
| н̇ | н + ◌̇ | U+043D U+0307 | ṅ (velar n) |
| Н̇ | Н + ◌̇ | U+041D U+0307 | Ṅ |
| м̇ | м + ◌̇ | U+043C U+0307 | ṁ (anusvara) |
| М̇ | М + ◌̇ | U+041C U+0307 | Ṁ |

### 4. Приголосні з акутом (U+0301)

| Комбінація | Base + Combining | Unicode послідовність | IAST еквівалент |
|------------|------------------|----------------------|-----------------|
| ш́ | ш + ◌́ | U+0448 U+0301 | ś (palatal sh) |
| Ш́ | Ш + ◌́ | U+0428 U+0301 | Ś |
| с́ | с + ◌́ | U+0441 U+0301 | ś (альтернатива) |
| С́ | С + ◌́ | U+0421 U+0301 | Ś |

### 5. Приголосні з тильдою (U+0303)

| Комбінація | Base + Combining | Unicode послідовність | IAST еквівалент |
|------------|------------------|----------------------|-----------------|
| н̃ | н + ◌̃ | U+043D U+0303 | ñ (palatal n) |
| Н̃ | Н + ◌̃ | U+041D U+0303 | Ñ |

### 6. Символи з чандрабінду (U+0310) — назалізація

| Комбінація | Base + Combining | Unicode послідовність | Призначення |
|------------|------------------|----------------------|-------------|
| м̐ | м + ◌̐ | U+043C U+0310 | candrabindu on м |
| М̐ | М + ◌̐ | U+041C U+0310 | Candrabindu on М |
| л̐ | л + ◌̐ | U+043B U+0310 | candrabindu on л |
| Л̐ | Л + ◌̐ | U+041B U+0310 | Candrabindu on Л |
| а̐ | а + ◌̐ | U+0430 U+0310 | nasalized а |
| о̐ | о + ◌̐ | U+043E U+0310 | nasalized о |

### 7. Подвійні діакритики (dot below + macron)

| Комбінація | Base + Combining | Unicode послідовність | IAST еквівалент |
|------------|------------------|----------------------|-----------------|
| р̣̄ | р + ◌̣ + ◌̄ | U+0440 U+0323 U+0304 | ṝ (long vocalic r) |
| Р̣̄ | Р + ◌̣ + ◌̄ | U+0420 U+0323 U+0304 | Ṝ |
| л̣̄ | л + ◌̣ + ◌̄ | U+043B U+0323 U+0304 | ḹ (long vocalic l) |
| Л̣̄ | Л + ◌̣ + ◌̄ | U+041B U+0323 U+0304 | Ḹ |

---

## Базові кириличні літери (що потребують anchor points)

### Малі літери (lowercase)

| Літера | Unicode | Потрібні діакритики |
|--------|---------|---------------------|
| а | U+0430 | macron, candrabindu |
| е | U+0435 | candrabindu |
| і | U+0456 | macron, candrabindu |
| о | U+043E | candrabindu |
| у | U+0443 | macron, candrabindu |
| д | U+0434 | dot below |
| л | U+043B | dot below, macron, candrabindu |
| м | U+043C | dot above, dot below, candrabindu |
| н | U+043D | dot above, dot below, tilde |
| р | U+0440 | dot below, macron |
| с | U+0441 | acute |
| т | U+0442 | dot below |
| х | U+0445 | dot below |
| ш | U+0448 | acute |

### Великі літери (uppercase)

| Літера | Unicode | Потрібні діакритики |
|--------|---------|---------------------|
| А | U+0410 | macron, candrabindu |
| Е | U+0415 | candrabindu |
| І | U+0406 | macron, candrabindu |
| О | U+041E | candrabindu |
| У | U+0423 | macron, candrabindu |
| Д | U+0414 | dot below |
| Л | U+041B | dot below, macron, candrabindu |
| М | U+041C | dot above, dot below, candrabindu |
| Н | U+041D | dot above, dot below, tilde |
| Р | U+0420 | dot below, macron |
| С | U+0421 | acute |
| Т | U+0422 | dot below |
| Х | U+0425 | dot below |
| Ш | U+0428 | acute |

---

## Технічні вимоги до шрифту

### 1. GPOS таблиця (Glyph Positioning)

Шрифт повинен містити **Mark-to-Base Positioning** (lookup type 4) для всіх комбінацій вище.

```
# Приклад OpenType feature code
feature mark {
    # Cyrillic lowercase
    markClass @MARK_ABOVE <anchor 0 700> mark @MARK_ABOVE_CLASS;
    markClass @MARK_BELOW <anchor 0 -100> mark @MARK_BELOW_CLASS;

    # Base anchors for Cyrillic н (U+043D)
    pos base \u043D <anchor 250 550> mark @MARK_ABOVE_CLASS;  # dot above
    pos base \u043D <anchor 250 0> mark @MARK_BELOW_CLASS;    # dot below

    # ... і так для всіх літер
} mark;
```

### 2. Anchor Points

Для кожної базової літери потрібно визначити:

- **top** — точка кріплення для діакритик зверху (macron, dot above, acute, tilde, candrabindu)
- **bottom** — точка кріплення для діакритик знизу (dot below)

Для літер з подвійними діакритиками (р̣̄, л̣̄):
- Порядок: base → dot below → macron (macron кріпиться до dot below, а не до base)

### 3. Рекомендований базовий шрифт

**Gentium Plus** (SIL OFL ліцензія) — найкращий кандидат для модифікації:
- Вже має гарну підтримку IAST латиниці
- Відкрита ліцензія
- Якісний дизайн для читання текстів
- Наявні вихідні файли (.glyphs, .ufo)

**Альтернативи:**
- Noto Serif (Apache 2.0)
- Linux Libertine (GPL/OFL)

---

## Приклади тестового тексту

### Базовий тест
```
пан̇ґум̇ лан̇ґг ш́аілам̇ мӯкам а̄ва кр̣па̄
```

### Маха-мантра
```
Харе Кр̣ш̣н̣а Харе Кр̣ш̣н̣а
Кр̣ш̣н̣а Кр̣ш̣н̣а Харе Харе
Харе Ра̄ма Харе Ра̄ма
Ра̄ма Ра̄ма Харе Харе
```

### Всі діакритики
```
а̄ і̄ ӯ р̣ р̣̄ л̣ л̣̄
т̣ д̣ н̣ м̣ х̣
н̇ м̇ н̃ ш́
м̐ л̐ а̐ о̐
```

### Повний алфавіт з діакритиками
```
Голосні: а а̄ і і̄ у ӯ е о
Вокальні: р̣ р̣̄ л̣ л̣̄
Гутуральні: к кх ґ ґг н̇
Палатальні: ч чх дж джх н̃
Церебральні: т̣ т̣х д̣ д̣х н̣
Дентальні: т тх д дг н
Лабіальні: п пх б бг м
Напівголосні: й р л в
Сибілянти: ш́ ш с
Аспірат: х
Анусвара: м̇
Вісарга: х̣
```

---

## JSON-формат для автоматизації

```json
{
  "combining_diacritics": {
    "U+0304": { "name": "COMBINING MACRON", "position": "above" },
    "U+0307": { "name": "COMBINING DOT ABOVE", "position": "above" },
    "U+0323": { "name": "COMBINING DOT BELOW", "position": "below" },
    "U+0301": { "name": "COMBINING ACUTE ACCENT", "position": "above" },
    "U+0303": { "name": "COMBINING TILDE", "position": "above" },
    "U+0310": { "name": "COMBINING CANDRABINDU", "position": "above" }
  },
  "cyrillic_bases": {
    "lowercase": {
      "U+0430": { "char": "а", "marks": ["U+0304", "U+0310"] },
      "U+0435": { "char": "е", "marks": ["U+0310"] },
      "U+0456": { "char": "і", "marks": ["U+0304", "U+0310"] },
      "U+043E": { "char": "о", "marks": ["U+0310"] },
      "U+0443": { "char": "у", "marks": ["U+0304", "U+0310"] },
      "U+0434": { "char": "д", "marks": ["U+0323"] },
      "U+043B": { "char": "л", "marks": ["U+0323", "U+0304", "U+0310"] },
      "U+043C": { "char": "м", "marks": ["U+0307", "U+0323", "U+0310"] },
      "U+043D": { "char": "н", "marks": ["U+0307", "U+0323", "U+0303"] },
      "U+0440": { "char": "р", "marks": ["U+0323", "U+0304"] },
      "U+0441": { "char": "с", "marks": ["U+0301"] },
      "U+0442": { "char": "т", "marks": ["U+0323"] },
      "U+0445": { "char": "х", "marks": ["U+0323"] },
      "U+0448": { "char": "ш", "marks": ["U+0301"] }
    },
    "uppercase": {
      "U+0410": { "char": "А", "marks": ["U+0304", "U+0310"] },
      "U+0415": { "char": "Е", "marks": ["U+0310"] },
      "U+0406": { "char": "І", "marks": ["U+0304", "U+0310"] },
      "U+041E": { "char": "О", "marks": ["U+0310"] },
      "U+0423": { "char": "У", "marks": ["U+0304", "U+0310"] },
      "U+0414": { "char": "Д", "marks": ["U+0323"] },
      "U+041B": { "char": "Л", "marks": ["U+0323", "U+0304", "U+0310"] },
      "U+041C": { "char": "М", "marks": ["U+0307", "U+0323", "U+0310"] },
      "U+041D": { "char": "Н", "marks": ["U+0307", "U+0323", "U+0303"] },
      "U+0420": { "char": "Р", "marks": ["U+0323", "U+0304"] },
      "U+0421": { "char": "С", "marks": ["U+0301"] },
      "U+0422": { "char": "Т", "marks": ["U+0323"] },
      "U+0425": { "char": "Х", "marks": ["U+0323"] },
      "U+0428": { "char": "Ш", "marks": ["U+0301"] }
    }
  },
  "required_combinations": [
    "U+0430 U+0304",
    "U+0456 U+0304",
    "U+0434 U+0323",
    "U+043B U+0323",
    "U+043B U+0323 U+0304",
    "U+043C U+0307",
    "U+043C U+0323",
    "U+043C U+0310",
    "U+043D U+0307",
    "U+043D U+0323",
    "U+043D U+0303",
    "U+0440 U+0323",
    "U+0440 U+0323 U+0304",
    "U+0441 U+0301",
    "U+0442 U+0323",
    "U+0445 U+0323",
    "U+0448 U+0301"
  ]
}
```

---

## Інструменти для модифікації

1. **FontForge** (безкоштовний) — для редагування anchor points
2. **Glyphs** (macOS, платний) — професійний інструмент
3. **fonttools** (Python) — для автоматизації через скрипти

### Приклад скрипта FontForge (Python)

```python
import fontforge

font = fontforge.open("GentiumPlus-Regular.ttf")

# Додаємо anchor points до кириличної н (U+043D)
glyph = font[0x043D]  # н
glyph.addAnchorPoint("top", "base", 250, 550)
glyph.addAnchorPoint("bottom", "base", 250, 0)

# Зберігаємо
font.generate("GentiumPlus-Ukrainian.ttf")
```

---

## Ліцензування

При модифікації шрифту необхідно:
1. Зберегти оригінальну ліцензію (SIL OFL для Gentium Plus)
2. Змінити назву шрифту (вимога OFL) — наприклад, "Vedavoice Serif"
3. Включити оригінальний copyright notice

---

## Контакти

Для замовлення модифікації шрифту можна звернутися до:
- [SIL International](https://software.sil.org/) — розробники Gentium Plus
- Фрілансери на Upwork/Fiverr з досвідом OpenType
- Українські типографи (наприклад, Rentafont)

---

*Документ створено: 2026-01-26*
*Проект: Vedavoice.org*
